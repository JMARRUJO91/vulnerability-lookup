from werkzeug.security import generate_password_hash

from website.models.user import User


def test_user(session):
    user = User(
        login="john",
        name="John Doe",
        pwdhash=generate_password_hash("password"),
        email="john@doe.example",
    )

    session.add(user)
    session.commit()

    assert user.is_admin is False
    assert user.is_active is True
    assert user.is_confirmed is False
    assert user.check_password("password") is True
    assert user.apikey != ""
